<div class="container mt-4">
  <div class="row">
    <div class="col-md-10 offset-md-1">
      <div class="row">
        <div class="col-md-4">
          <p-dropdown [options]="topics" [(ngModel)]="selectedTopic" placeholder="Select a Topic" optionLabel="key"
          optionValue="value" [showClear]="true" (ngModelChange)="OnTopicSelection()">
          </p-dropdown>
        </div>
        <div class="col-md-4">
          <p-dropdown [options]="subTopic" [(ngModel)]="selectedSubTopic" placeholder="Select a Sub Topic" optionLabel="key"
          optionValue="value" [showClear]="true" (ngModelChange)="OnSubTopicSelection()">
          </p-dropdown>
        </div>
        <div class="col-md-3">
          <p-button label="Submit" (onClick)="AddSubscription()"></p-button>
        </div>
      </div>
      <div class="row mt-4">
        <h4>Your Subscriptions</h4>
      </div>
      <div class="row mt-4">
        <div class="alert alert-primary" role="alert" *ngFor="let item of subscriptionData">
          <div class="row">
            <div class="col-md-3"><h5>{{item.key}} : </h5></div>
            <div class="col-md-2" *ngFor="let topic of item.topics">
              <p-chip label={{topic}}></p-chip>
            </div>
          </div>
        </div>
      </div>
      <div class="row mt-4">
        <p-tabView>
          <p-tabPanel header="New Messages">
            <p-table [value]="newMessage" responsiveLayout="scroll">
              <ng-template pTemplate="header">
                  <tr>
                      <th>Message Id</th>
                      <th>Topic</th>
                      <th>Sub Topic</th>
                      <th>Message</th>
                      <th>Date</th>
                  </tr>
              </ng-template>
              <ng-template pTemplate="body" let-product>
                  <tr>
                      <td>{{product.Message_id}}</td>
                      <td>{{product.Topic}}</td>
                      <td>{{product.Sub_topic}}</td>
                      <td>{{product.Message}}</td>
                      <td>{{product.Date}}</td>

                  </tr>
              </ng-template>
          </p-table>

          </p-tabPanel>
          <p-tabPanel header="Old Messages">
            <div class="row">
              <div class="col-md-3 offset-md-9">
                <p-button label="Mark all as Read" (onClick)="MarkAsRead()"></p-button>
              </div>
            </div>
            <p-table [value]="oldMessages" responsiveLayout="scroll">
              <ng-template pTemplate="header">
                <tr>
                  <th>Message Id</th>
                  <th>Topic</th>
                  <th>Sub Topic</th>
                  <th>Message</th>
                  <th>Date</th>
                  <th></th>
              </tr>
          </ng-template>
          <ng-template pTemplate="body" let-product>
              <tr>
                  <td>{{product.Message_id.substring(0,3)}}</td>
                  <td>{{product.Topic}}</td>
                  <td>{{product.Sub_topic}}</td>
                  <td>{{product.Message}}</td>
                  <td>{{product.Date}}</td>

              </tr>
              </ng-template>
          </p-table>
          </p-tabPanel>
      </p-tabView>
      </div>
    </div>
  </div>
</div>
